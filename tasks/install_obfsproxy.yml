---

- include: install_python_virtualenv_manually.yml
  when: (tor_obfs4proxy_install_in_virtualenv and
         tor_install_python_virtualenv_manually)

- name: Ensure virtualenv is installed
  apt:
    pkg: '{{ item }}'
    state: latest
  with_items:
    - 'python-virtualenv'
  when: (ansible_pkg_mgr == 'apt' and tor_obfs4proxy_install_in_virtualenv and
         not tor_install_python_virtualenv_manually)

- name: Ensure obfsproxy packages are installed
  apt:
    pkg: '{{ item }}'
    state: latest
  with_items: tor_obfs4proxy_packages
  when: (ansible_pkg_mgr == 'apt' and not tor_obfs4proxy_install_in_virtualenv and
         not tor_install_python_virtualenv_manually)

- include: install_pip_obfsproxy.yml
  when: tor_obfs4proxy_install_in_virtualenv
